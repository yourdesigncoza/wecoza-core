---
wave: 1
depends_on: []
files_modified:
  - schema/migrations/002-drop-trigger-infrastructure.sql
autonomous: true
---

# Plan 01: Drop Trigger Infrastructure

**Phase:** 13 - Database Cleanup
**Requirement:** DB-01, DB-02, DB-03

## Objective

Remove PostgreSQL trigger infrastructure that auto-generates tasks from class changes.

## Tasks

<task id="1">
Create migration file schema/migrations/002-drop-trigger-infrastructure.sql with:
- DROP TRIGGER IF EXISTS classes_log_insert_update ON classes
- DROP FUNCTION IF EXISTS log_class_change()
- DROP TABLE IF EXISTS class_change_logs CASCADE
Wrap in BEGIN/COMMIT transaction.
</task>

<task id="2">
Execute migration against PostgreSQL database using psql or MCP tool.
</task>

<task id="3">
Verify removal with queries:
- SELECT tgname FROM pg_trigger WHERE tgname = 'classes_log_insert_update' (0 rows)
- SELECT proname FROM pg_proc WHERE proname = 'log_class_change' (0 rows)
- SELECT tablename FROM pg_tables WHERE tablename = 'class_change_logs' (0 rows)
</task>

## Verification

```sql
-- All should return 0 rows
SELECT tgname FROM pg_trigger WHERE tgname = 'classes_log_insert_update';
SELECT proname FROM pg_proc WHERE proname = 'log_class_change';
SELECT tablename FROM pg_tables WHERE tablename = 'class_change_logs';
```

## must_haves

- [ ] Trigger classes_log_insert_update removed
- [ ] Function log_class_change() removed
- [ ] Table class_change_logs removed (with indexes, sequence, FK)
- [ ] No PostgreSQL errors on class operations
